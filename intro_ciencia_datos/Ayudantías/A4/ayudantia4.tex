% Options for packages loaded elsewhere
% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrartcl}
\usepackage{xcolor}
\usepackage[top=30mm,left=20mm]{geometry}
\usepackage{amsmath,amssymb}
\setcounter{secnumdepth}{5}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math} % this also loads fontspec
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else
  % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
% Make \paragraph and \subparagraph free-standing
\makeatletter
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}{
    \@ifstar
      \xxxParagraphStar
      \xxxParagraphNoStar
  }
  \newcommand{\xxxParagraphStar}[1]{\oldparagraph*{#1}\mbox{}}
  \newcommand{\xxxParagraphNoStar}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}{
    \@ifstar
      \xxxSubParagraphStar
      \xxxSubParagraphNoStar
  }
  \newcommand{\xxxSubParagraphStar}[1]{\oldsubparagraph*{#1}\mbox{}}
  \newcommand{\xxxSubParagraphNoStar}[1]{\oldsubparagraph{#1}\mbox{}}
\fi
\makeatother

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\newsavebox\pandoc@box
\newcommand*\pandocbounded[1]{% scales image to fit in text height/width
  \sbox\pandoc@box{#1}%
  \Gscale@div\@tempa{\textheight}{\dimexpr\ht\pandoc@box+\dp\pandoc@box\relax}%
  \Gscale@div\@tempb{\linewidth}{\wd\pandoc@box}%
  \ifdim\@tempb\p@<\@tempa\p@\let\@tempa\@tempb\fi% select the smaller of both
  \ifdim\@tempa\p@<\p@\scalebox{\@tempa}{\usebox\pandoc@box}%
  \else\usebox{\pandoc@box}%
  \fi%
}
% Set default figure placement to htbp
\def\fps@figure{htbp}
\makeatother

\ifLuaTeX
  \usepackage{luacolor}
  \usepackage[soul]{lua-ul}
\else
  \usepackage{soul}
\fi




\setlength{\emergencystretch}{3em} % prevent overfull lines

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}



 


\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\usepackage{bookmark}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same}
\hypersetup{
  pdftitle={Ayudant√≠a: APIs y Webscraping},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}


\title{Ayudant√≠a: APIs y Webscraping}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{IMT2200 2025-2}
\author{}
\date{}
\begin{document}
\maketitle

\renewcommand*\contentsname{Contenido}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{3}
\tableofcontents
}

\section{Introducci√≥n}\label{introducciuxf3n}

En esta ayudant√≠a veremos de manera introductoria:

\begin{itemize}
\tightlist
\item
  Qu√© es HTML y porqu√© nos sirve saber de √©l.
\item
  Qu√© son los protocolos y c√≥mo se relacionan con la web.
\item
  Ejemplos pr√°cticos de Webscraping en Python.
\item
  Ejemplo de uso de una API.
\end{itemize}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{¬øQu√© es HTML?}\label{quuxe9-es-html}

HTML es el lenguaje de marcado que estructura el contenido de la web, de
ah√≠ vienen los archivos \emph{\texttt{nombre.html}} . Estos archivos son
los que visualizamos a la hora de entrar a cualquier p√°gina web, es lo
que los navegadores procesan y muestran en nuestras pantallas.

Este lenguaje tiene una estructura y una l√≥gica. No es necesario que
conozcamos todas sus caracter√≠sticas, pero s√≠ entendamos c√≥mo se
comporta.

Los bloques que construyen un \emph{\texttt{archivo.html}} son las
\textbf{etiquetas/tags} (eg:
\texttt{\textless{}h1\textgreater{}},\texttt{\textless{}p\textgreater{}},\texttt{\textless{}div\textgreater{}},
etc), cada una de estas es interpretada como un distinto tipo de
informaci√≥n o bloque y contienen caracter√≠sticas intr√≠nsecas (que pueden
ser modificadas).

Por ejemplo :

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{\textless{}h1\textgreater{}Hola mundo\textless{}/h1\textgreater{}}
\NormalTok{\textless{}p\textgreater{}Este es un p√°rrafo con un \textless{}a href="https://www.wikipedia.org"\textgreater{}link\textless{}/a\textgreater{}.\textless{}/p\textgreater{}}
\end{Highlighting}
\end{Shaded}

Se renderizar√≠a en una p√°gina web as√≠ :

Hola mundo

Este es un p√°rrafo con un link.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Podemos hacernos una idea visual del comportamiento de los elementos
como sigue:

\begin{figure}[H]

{\centering \includegraphics[width=0.5\linewidth,height=0.5\textheight]{imgs/html.png}

}

\caption{Esquema HTML}

\end{figure}%

Es bueno pensar que cada etiqueta \textbf{html} es como un objeto de
\textbf{python}, y por lo tanto tiene atributos (que son las cosas que
podemos editar), los que nos sirve saber para este curso :

\begin{itemize}
\item
  \texttt{id}: Identificador √∫nico de alg√∫n elemento.
\item
  \texttt{class}: Clase o categor√≠a a la que pertenece el elemento, por
  ejemplo: \texttt{class="img-pequenas"}.
\item
  \texttt{style}: Estilos CSS aplicados al elemento. Aqu√≠ podemos
  modificar m√°rgenes, anchos, alturas, relleno, colores, etc. Es todo
  otro lenguaje, que se escapa del alcance del curso.
\end{itemize}

Ahora, que conocemos el material con el que se trabaja en la web, veamos
c√≥mo se comunican los diferentes agentes de este proceso, y que hacen
posible la existencia del internet.

\section{Protocolos: HTTP y HTTPS}\label{protocolos-http-y-https}

Para que sea posible acceder a una p√°gina web, dependiendo de su
contenido, pasan una serie de procesos y protocolos. Tenemos
\textbf{HTTP} (HyperText Transfer Protocol) y su versi√≥n segura
\textbf{HTTPS} (HTTP Secure).

Podemos decir que este protocolo se compone de los siguientes pasos:

\begin{itemize}
\tightlist
\item
  Tu navegador (cliente) env√≠a una solicitud (request).(¬øA qui√©n? üßê)
\item
  Digamos que a otro computador, el servidor le llamaremos, quien recibe
  esa se√±al, dependiendo del mensaje, da una respuesta.
\item
  la respuesta llega, y el navegador la procesa para mostrarla al
  usuario.
\end{itemize}

(esta ejemplificaci√≥n est√° muy simplificada, pero es la idea general)

\begin{figure}[H]

{\centering \includegraphics[width=0.5\linewidth,height=0.5\textheight]{imgs/cliente.png}

}

\caption{Arquitectura Cliente-Servidor}

\end{figure}%

\subsubsection{Las solicitudes (HTTP
Requests)}\label{las-solicitudes-http-requests}

Las solicitudes HTTP son la forma en que los navegadores y otros
clientes se comunican con los servidores. Estas anticipan la naturaleza
de la interacci√≥n que se desea tener con el servidor. Las m√°s relevantes
son:

\begin{itemize}
\tightlist
\item
  \textbf{GET}: Solicita datos del servidor. Es la m√°s com√∫n y se
  utiliza para obtener informaci√≥n.
\item
  \textbf{POST}: Env√≠a datos al servidor. Se utiliza para enviar
  informaci√≥n, como formularios.
\item
  \textbf{PUT}: Actualiza datos en el servidor.
\item
  \textbf{DELETE}: Elimina datos del servidor.
\end{itemize}

\ul{üëâ \textbf{Ejemplo:}}

Cuando escribes \texttt{https://www.google.com}, tu navegador hace un
GET al servidor de Google. Google recibe la solicitud, la revisa y
responde con su p√°gina de inicio. Esto finalmente se muestra en tu
navegador.

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

\section{Webscraping}\label{webscraping}

¬øDe que nos sirve saber todo esto? En ciencia de datos, muchas veces
queremos extraer informaci√≥n de p√°ginas web. Entonces, ahora que ya
conocemos, a grandes rasgos, el comportamiento y estructura de la web,
podemos entender mejor los procesos que son necesarios para el
Webscraping.

Pero ¬øqu√© es el Webscraping? Es la t√©cnica utilizada para extraer
informaci√≥n de sitios web de manera automatizada (cuando no podemos
obtener la informaci√≥n de otra forma). En esta ocasi√≥n ocuparemos
algunas librerias de python para hacer el scrapping HTML de las p√°ginas
web.

Veamos un peque√±o ejemplo :

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ requests}
\ImportTok{from}\NormalTok{ bs4 }\ImportTok{import}\NormalTok{ BeautifulSoup}

\NormalTok{url }\OperatorTok{=} \StringTok{"https://quotes.toscrape.com/"}
\NormalTok{response }\OperatorTok{=}\NormalTok{ requests.get(url) }\CommentTok{\# Hacemos la solicitud GET}
\BuiltInTok{print}\NormalTok{(response.status\_code) }\CommentTok{\# 200 es que todo sali√≥ bien}
\BuiltInTok{print}\NormalTok{(response)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
200
<Response [200]>
\end{verbatim}

\textbf{¬øQu√© esta pasando?}

\texttt{response.text} nos da el HTML (de la p√°gina que solicitamos)
como un string. Luego usaremos \emph{BeautifulSoup} para transformar ese
string de HTML en una estructura m√°s manejable.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{bs }\OperatorTok{=}\NormalTok{ BeautifulSoup(response.text, }\StringTok{\textquotesingle{}html.parser\textquotesingle{}}\NormalTok{) }\CommentTok{\# Parseamos el HTML}
\NormalTok{quotes }\OperatorTok{=}\NormalTok{ [q.get\_text() }\ControlFlowTok{for}\NormalTok{ q }\KeywordTok{in}\NormalTok{ bs.select(}\StringTok{".quote span.text"}\NormalTok{)]}
\NormalTok{quotes[:}\DecValTok{5}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
['‚ÄúThe world as we have created it is a process of our thinking. It cannot be changed without changing our thinking.‚Äù',
 '‚ÄúIt is our choices, Harry, that show what we truly are, far more than our abilities.‚Äù',
 '‚ÄúThere are only two ways to live your life. One is as though nothing is a miracle. The other is as though everything is a miracle.‚Äù',
 '‚ÄúThe person, be it gentleman or lady, who has not pleasure in a good novel, must be intolerably stupid.‚Äù',
 "‚ÄúImperfection is beauty, madness is genius and it's better to be absolutely ridiculous than absolutely boring.‚Äù"]
\end{verbatim}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Pero lo que buscamos es informaci√≥n espec√≠fica.Con \texttt{.select()}
buscamos dentro del HTML todos los elementos que cumplan con lo
especificado en los argumentos.

En este caso:

\texttt{.quote} significa ``cualquier elemento con la clase quote'' (las
clases se designan con un ``\textbf{.}'').

\texttt{span.text} significa ``dentro de eso, los
\texttt{\textless{}span\textgreater{}} que tengan la clase text''.

Esto nos devuelve una lista de esos elementos solicitados. Luego
simplemente imprimimos los primeros 5 para verificar que se ejecut√≥
correctamente nuestro c√≥digo.

\section{APIs}\label{apis}

Como ya vieron en clases, tambi√©n existen las APIs (Application
Programming Interfaces) que nos permiten obtener datos de forma
estructurada, sin necesidad de webscraping. Las APIs tambi√©n requieren
cierto protocolo y estructura, dependen sobre todo del proveedor.
Algunas son de libre acceso, otras pagadas, otras requieren
autenticaci√≥n, etc.

Ejemplo manejo de una API p√∫blica (Pok√©mon):

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ requests}

\NormalTok{url }\OperatorTok{=} \StringTok{"https://pokeapi.co/api/v2/pokemon/pikachu"}
\NormalTok{data }\OperatorTok{=}\NormalTok{ requests.get(url).json() }\CommentTok{\# pasamos la respuesta a JSON}
\NormalTok{data[}\StringTok{"abilities"}\NormalTok{] }\CommentTok{\# JSON podemos acceder a los atributos como si fuera un diccionario (tiene estructura clave:valor)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
[{'ability': {'name': 'static', 'url': 'https://pokeapi.co/api/v2/ability/9/'},
  'is_hidden': False,
  'slot': 1},
 {'ability': {'name': 'lightning-rod',
   'url': 'https://pokeapi.co/api/v2/ability/31/'},
  'is_hidden': True,
  'slot': 3}]
\end{verbatim}

Para una API que requiere API Key, podemos hacer lo sgte :

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{import}\NormalTok{ requests}
\ImportTok{import}\NormalTok{ datetime}

\NormalTok{API\_KEY }\OperatorTok{=} \StringTok{"DEMO\_KEY"}
\NormalTok{date }\OperatorTok{=}\NormalTok{ datetime.date.today() }\OperatorTok{{-}}\NormalTok{ datetime.timedelta(days}\OperatorTok{=}\DecValTok{1}\NormalTok{)}

\NormalTok{url }\OperatorTok{=} \SpecialStringTok{F"https://api.nasa.gov/planetary/apod?api\_key=}\SpecialCharTok{\{}\NormalTok{API\_KEY}\SpecialCharTok{\}}\SpecialStringTok{\&date=}\SpecialCharTok{\{}\NormalTok{date}\SpecialCharTok{\}}\SpecialStringTok{"}
\NormalTok{headers }\OperatorTok{=}\NormalTok{ \{}
    \StringTok{"Authorization"}\NormalTok{: }\SpecialStringTok{f"Bearer }\SpecialCharTok{\{}\NormalTok{API\_KEY}\SpecialCharTok{\}}\SpecialStringTok{"}
\NormalTok{\}}
\NormalTok{data }\OperatorTok{=}\NormalTok{ requests.get(url, headers}\OperatorTok{=}\NormalTok{headers).json()}
\NormalTok{data}
\end{Highlighting}
\end{Shaded}

\begin{center}\rule{0.5\linewidth}{0.5pt}\end{center}

Es muy similar a la anterior, pero ahora el proveedor nos esta pidiendo
una autenticaci√≥n antes de darnos acceso a los datos. Sin esa
autenticaci√≥n no podemos hacer nada. Esta es una forma com√∫n de proteger
las APIs y asegurar que solo los usuarios autorizados puedan acceder a
los datos ( y tambi√©n modificarlos, seg√∫n su nivel de acceso).

\begin{figure}[H]

{\centering \includegraphics[width=0.5\linewidth,height=0.5\textheight]{imgs/api.avif}

}

\caption{Arquitectura API}

\end{figure}%




\end{document}
